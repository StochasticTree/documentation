"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[9028],{2268:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"r-documentation-markdown/createBCFModelFromJson","title":"createBCFModelFromJson","description":"Description","source":"@site/docs/r-documentation-markdown/createBCFModelFromJson.md","sourceDirName":"r-documentation-markdown","slug":"/r-documentation-markdown/createBCFModelFromJson","permalink":"/documentation/docs/r-documentation-markdown/createBCFModelFromJson","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/r-documentation-markdown/createBCFModelFromJson.md","tags":[],"version":"current","frontMatter":{"title":"createBCFModelFromJson"},"sidebar":"tutorialSidebar","previous":{"title":"createBARTModelFromJsonString","permalink":"/documentation/docs/r-documentation-markdown/createBARTModelFromJsonString"},"next":{"title":"createBCFModelFromJsonFile","permalink":"/documentation/docs/r-documentation-markdown/createBCFModelFromJsonFile"}}');var o=t(4848),s=t(8453);const i={title:"createBCFModelFromJson"},a="Convert an (in-memory) JSON representation of a BCF model to a BCF model object",d={},c=[{value:"Description",id:"description",level:2},{value:"Usage",id:"usage",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Value",id:"value",level:2},{value:"Examples",id:"examples",level:2}];function _(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"convert-an-in-memory-json-representation-of-a-bcf-model-to-a-bcf-model-object",children:"Convert an (in-memory) JSON representation of a BCF model to a BCF model object"})}),"\n",(0,o.jsx)(e.h2,{id:"description",children:"Description"}),"\n",(0,o.jsx)(e.p,{children:"Convert an (in-memory) JSON representation of a BCF model to a BCF model object\nwhich can be used for prediction, etc..."}),"\n",(0,o.jsx)(e.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-r",children:"createBCFModelFromJson(json_object)\n"})}),"\n",(0,o.jsx)(e.h2,{id:"arguments",children:"Arguments"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"json_object"}),": Object of type ",(0,o.jsx)(e.code,{children:"CppJson"})," containing Json representation of a BCF model"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"value",children:"Value"}),"\n",(0,o.jsxs)(e.p,{children:["Object of type ",(0,o.jsx)(e.code,{children:"bcf"})]}),"\n",(0,o.jsx)(e.h2,{id:"examples",children:"Examples"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-r",children:"n \\<- 500\nx1 \\<- rnorm(n)\nx2 \\<- rnorm(n)\nx3 \\<- rnorm(n)\nx4 \\<- as.numeric(rbinom(n,1,0.5))\nx5 \\<- as.numeric(sample(1:3,n,replace=TRUE))\nX \\<- cbind(x1,x2,x3,x4,x5)\np \\<- ncol(X)\ng \\<- function(x) \\{ifelse(x[,5]==1,2,ifelse(x[,5]==2,-1,4))\\}\nmu1 \\<- function(x) \\{1+g(x)+x[,1]*x[,3]\\}\nmu2 \\<- function(x) \\{1+g(x)+6*abs(x[,3]-1)\\}\ntau1 \\<- function(x) \\{rep(3,nrow(x))\\}\ntau2 \\<- function(x) \\{1+2*x[,2]*x[,4]\\}\nmu_x \\<- mu1(X)\ntau_x \\<- tau2(X)\npi_x \\<- 0.8*pnorm((3*mu_x/sd(mu_x)) - 0.5*X[,1]) + 0.05 + runif(n)/10\nZ \\<- rbinom(n,1,pi_x)\nE_XZ \\<- mu_x + Z*tau_x\nsnr \\<- 3\ngroup_ids \\<- rep(c(1,2), n %/% 2)\nrfx_coefs \\<- matrix(c(-1, -1, 1, 1), nrow=2, byrow=TRUE)\nrfx_basis \\<- cbind(1, runif(n, -1, 1))\nrfx_term \\<- rowSums(rfx_coefs[group_ids,] * rfx_basis)\ny \\<- E_XZ + rfx_term + rnorm(n, 0, 1)*(sd(E_XZ)/snr)\nX \\<- as.data.frame(X)\nX$x4 \\<- factor(X$x4, ordered = TRUE)\nX$x5 \\<- factor(X$x5, ordered = TRUE)\ntest_set_pct \\<- 0.2\nn_test \\<- round(test_set_pct*n)\nn_train \\<- n - n_test\ntest_inds \\<- sort(sample(1:n, n_test, replace = FALSE))\ntrain_inds \\<- (1:n)[!((1:n) %in% test_inds)]\nX_test \\<- X[test_inds,]\nX_train \\<- X[train_inds,]\npi_test \\<- pi_x[test_inds]\npi_train \\<- pi_x[train_inds]\nZ_test \\<- Z[test_inds]\nZ_train \\<- Z[train_inds]\ny_test \\<- y[test_inds]\ny_train \\<- y[train_inds]\nmu_test \\<- mu_x[test_inds]\nmu_train \\<- mu_x[train_inds]\ntau_test \\<- tau_x[test_inds]\ntau_train \\<- tau_x[train_inds]\ngroup_ids_test \\<- group_ids[test_inds]\ngroup_ids_train \\<- group_ids[train_inds]\nrfx_basis_test \\<- rfx_basis[test_inds,]\nrfx_basis_train \\<- rfx_basis[train_inds,]\nrfx_term_test \\<- rfx_term[test_inds]\nrfx_term_train \\<- rfx_term[train_inds]\nbcf_model \\<- bcf(X_train = X_train, Z_train = Z_train, y_train = y_train, \n```r\n             pi_train = pi_train, group_ids_train = group_ids_train, \n             rfx_basis_train = rfx_basis_train, X_test = X_test, \n             Z_test = Z_test, pi_test = pi_test, group_ids_test = group_ids_test,\n             rfx_basis_test = rfx_basis_test, \n             num_gfr = 100, num_burnin = 0, num_mcmc = 100, \n             sample_sigma_leaf_mu = TRUE, sample_sigma_leaf_tau = FALSE)\n"})}),"\n",(0,o.jsx)(e.h1,{id:"bcf_json---convertbcfmodeltojsonbcf_model",children:"bcf_json <- convertBCFModelToJson(bcf_model)"}),"\n",(0,o.jsx)(e.h1,{id:"bcf_model_roundtrip---createbcfmodelfromjsonbcf_json",children:"bcf_model_roundtrip <- createBCFModelFromJson(bcf_json)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{})})]})}function m(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(_,{...n})}):_(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>a});var r=t(6540);const o={},s=r.createContext(o);function i(n){const e=r.useContext(s);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);