"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4013],{5054:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"python-documentation-markdown/causal","title":"Causal Inference","description":"This vignette provides a quick overview (using simulated data) of how to use stochtree for causal inference.","source":"@site/docs/python-documentation-markdown/causal.md","sourceDirName":"python-documentation-markdown","slug":"/python-documentation-markdown/causal","permalink":"/documentation/docs/python-documentation-markdown/causal","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/python-documentation-markdown/causal.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"StochTree API","permalink":"/documentation/docs/python-documentation-markdown/api"},"next":{"title":"StochTree","permalink":"/documentation/docs/python-documentation-markdown/"}}');var s=t(4848),o=t(8453);const r={},i="Causal Inference",c={},d=[];function u(n){const e={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"causal-inference",children:"Causal Inference"})}),"\n",(0,s.jsxs)(e.p,{children:["This vignette provides a quick overview (using simulated data) of how to use ",(0,s.jsx)(e.code,{children:"stochtree"})," for causal inference.\nStart by loading stochtree\u2019s ",(0,s.jsx)(e.code,{children:"BCFModel"})," class and a number of other packages."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom stochtree import BCFModel\nfrom sklearn.model_selection import train_test_split\n"})}),"\n",(0,s.jsx)(e.p,{children:"Now, we generate a simulated causal inference problem"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# RNG\nrandom_seed = 101\nrng = np.random.default_rng(random_seed)\n\n# Generate covariates and basis\nn = 1000\np_X = 5\nX = rng.uniform(0, 1, (n, p_X))\npi_X = 0.25 + 0.5*X[:,0]\nZ = rng.binomial(1, pi_X, n).astype(float)\n\n# Define the outcome mean functions (prognostic and treatment effects)\nmu_X = pi_X*5\n# tau_X = np.sin(X[:,1]*2*np.pi)\ntau_X = X[:,1]*2\n\n# Generate outcome\nepsilon = rng.normal(0, 1, n)\ny = mu_X + tau_X*Z + epsilon\n"})}),"\n",(0,s.jsx)(e.p,{children:"Split the dataset into train and test sets"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"sample_inds = np.arange(n)\ntrain_inds, test_inds = train_test_split(sample_inds, test_size=0.5)\nX_train = X[train_inds,:]\nX_test = X[test_inds,:]\nZ_train = Z[train_inds]\nZ_test = Z[test_inds]\ny_train = y[train_inds]\ny_test = y[test_inds]\npi_train = pi_X[train_inds]\npi_test = pi_X[test_inds]\nmu_train = mu_X[train_inds]\nmu_test = mu_X[test_inds]\ntau_train = tau_X[train_inds]\ntau_test = tau_X[test_inds]\n"})}),"\n",(0,s.jsx)(e.p,{children:"Initialize and run a BCF sampler for 1000 iterations (after 10 \u201cwarm-start\u201d draws)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"bcf_model = BCFModel()\nbcf_model.sample(X_train, Z_train, y_train, pi_train, X_test, Z_test, pi_test, num_gfr=10, num_mcmc=1000)\n"})})]})}function l(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(u,{...n})}):u(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>i});var a=t(6540);const s={},o=a.createContext(s);function r(n){const e=a.useContext(o);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),a.createElement(o.Provider,{value:e},n.children)}}}]);