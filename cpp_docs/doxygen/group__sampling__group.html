<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StochTree: Forest Sampler API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">StochTree<span id="projectnumber">&#160;0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Forest Sampler API</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for sampling from a forest. The core interfce of these functions, as used by the R, Python, and standalone C++ program, is defined by <a class="el" href="group__sampling__group.html#ga08eabd64880e15e5ee94e8ad48110208">MCMCSampleOneIter</a>, which runs one iteration of the MCMC sampler for a given forest, and <a class="el" href="group__sampling__group.html#ga68c34c1d30d2ad0503b30e396ec97c09">GFRSampleOneIter</a>, which runs one iteration of the grow-from-root (GFR) algorithm for a given forest. All other functions are essentially helpers used in a sampling function, which are documented here to make extending the C++ codebase more straightforward.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1a6133404b4f375fe32036846dd24751" id="r_ga1a6133404b4f375fe32036846dd24751"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sampling__group.html#ga1a6133404b4f375fe32036846dd24751">StochTree::VarSplitRange</a> (<a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;tracker, <a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;dataset, int tree_num, int leaf_split, int feature_split, double &amp;var_min, double &amp;var_max)</td></tr>
<tr class="memdesc:ga1a6133404b4f375fe32036846dd24751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computer the range of available split values for a continuous variable, given the current structure of a tree.  <br /></td></tr>
<tr class="separator:ga1a6133404b4f375fe32036846dd24751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40394b4b31bc161a33b2f169e7ecbc55" id="r_ga40394b4b31bc161a33b2f169e7ecbc55"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sampling__group.html#ga40394b4b31bc161a33b2f169e7ecbc55">StochTree::NodesNonConstantAfterSplit</a> (<a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;dataset, <a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;tracker, <a class="el" href="classStochTree_1_1TreeSplit.html">TreeSplit</a> &amp;split, int tree_num, int leaf_split, int feature_split)</td></tr>
<tr class="memdesc:ga40394b4b31bc161a33b2f169e7ecbc55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether a proposed split creates two leaf nodes with constant values for every feature (thus ensuring that the tree cannot split further).  <br /></td></tr>
<tr class="separator:ga40394b4b31bc161a33b2f169e7ecbc55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68c34c1d30d2ad0503b30e396ec97c09" id="r_ga68c34c1d30d2ad0503b30e396ec97c09"><td class="memTemplParams" colspan="2">template&lt;typename LeafModel , typename LeafSuffStat , typename... LeafSuffStatConstructorArgs&gt; </td></tr>
<tr class="memitem:ga68c34c1d30d2ad0503b30e396ec97c09"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__sampling__group.html#ga68c34c1d30d2ad0503b30e396ec97c09">StochTree::GFRSampleOneIter</a> (<a class="el" href="classStochTree_1_1TreeEnsemble.html">TreeEnsemble</a> &amp;active_forest, <a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;tracker, <a class="el" href="classStochTree_1_1ForestContainer.html">ForestContainer</a> &amp;forests, LeafModel &amp;leaf_model, <a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;dataset, <a class="el" href="classStochTree_1_1ColumnVector.html">ColumnVector</a> &amp;residual, <a class="el" href="classStochTree_1_1TreePrior.html">TreePrior</a> &amp;tree_prior, std::mt19937 &amp;gen, std::vector&lt; double &gt; &amp;variable_weights, double global_variance, std::vector&lt; FeatureType &gt; &amp;feature_types, int cutpoint_grid_size, bool keep_forest, bool pre_initialized, bool backfitting, LeafSuffStatConstructorArgs &amp;... leaf_suff_stat_args)</td></tr>
<tr class="separator:ga68c34c1d30d2ad0503b30e396ec97c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08eabd64880e15e5ee94e8ad48110208" id="r_ga08eabd64880e15e5ee94e8ad48110208"><td class="memTemplParams" colspan="2">template&lt;typename LeafModel , typename LeafSuffStat , typename... LeafSuffStatConstructorArgs&gt; </td></tr>
<tr class="memitem:ga08eabd64880e15e5ee94e8ad48110208"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__sampling__group.html#ga08eabd64880e15e5ee94e8ad48110208">StochTree::MCMCSampleOneIter</a> (<a class="el" href="classStochTree_1_1TreeEnsemble.html">TreeEnsemble</a> &amp;active_forest, <a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;tracker, <a class="el" href="classStochTree_1_1ForestContainer.html">ForestContainer</a> &amp;forests, LeafModel &amp;leaf_model, <a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;dataset, <a class="el" href="classStochTree_1_1ColumnVector.html">ColumnVector</a> &amp;residual, <a class="el" href="classStochTree_1_1TreePrior.html">TreePrior</a> &amp;tree_prior, std::mt19937 &amp;gen, std::vector&lt; double &gt; &amp;variable_weights, double global_variance, bool keep_forest, bool pre_initialized, bool backfitting, LeafSuffStatConstructorArgs &amp;... leaf_suff_stat_args)</td></tr>
<tr class="memdesc:ga08eabd64880e15e5ee94e8ad48110208"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs one iteration of the MCMC sampler for a tree ensemble model, which consists of two steps for every tree in a forest:  <br /></td></tr>
<tr class="separator:ga08eabd64880e15e5ee94e8ad48110208"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for sampling from a forest. The core interfce of these functions, as used by the R, Python, and standalone C++ program, is defined by <a class="el" href="group__sampling__group.html#ga08eabd64880e15e5ee94e8ad48110208">MCMCSampleOneIter</a>, which runs one iteration of the MCMC sampler for a given forest, and <a class="el" href="group__sampling__group.html#ga68c34c1d30d2ad0503b30e396ec97c09">GFRSampleOneIter</a>, which runs one iteration of the grow-from-root (GFR) algorithm for a given forest. All other functions are essentially helpers used in a sampling function, which are documented here to make extending the C++ codebase more straightforward. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1a6133404b4f375fe32036846dd24751" name="ga1a6133404b4f375fe32036846dd24751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a6133404b4f375fe32036846dd24751">&#9670;&#160;</a></span>VarSplitRange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void StochTree::VarSplitRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tree_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>leaf_split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>feature_split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>var_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>var_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computer the range of available split values for a continuous variable, given the current structure of a tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>Tracking data structures that speed up sampler operations. </td></tr>
    <tr><td class="paramname">dataset</td><td>Data object containining training data, including covariates, leaf regression bases, and case weights. </td></tr>
    <tr><td class="paramname">tree_num</td><td>Index of the tree for which a split is proposed. </td></tr>
    <tr><td class="paramname">leaf_split</td><td>Index of the leaf in <code>tree_num</code> for which a split is proposed. </td></tr>
    <tr><td class="paramname">feature_split</td><td>Index of the feature that we will query the available range. </td></tr>
    <tr><td class="paramname">var_min</td><td>Current minimum feature value (called by refence and modified by this function). </td></tr>
    <tr><td class="paramname">var_max</td><td>Current maximum feature value (called by refence and modified by this function). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga40394b4b31bc161a33b2f169e7ecbc55" name="ga40394b4b31bc161a33b2f169e7ecbc55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40394b4b31bc161a33b2f169e7ecbc55">&#9670;&#160;</a></span>NodesNonConstantAfterSplit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool StochTree::NodesNonConstantAfterSplit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1TreeSplit.html">TreeSplit</a> &amp;&#160;</td>
          <td class="paramname"><em>split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tree_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>leaf_split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>feature_split</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines whether a proposed split creates two leaf nodes with constant values for every feature (thus ensuring that the tree cannot split further). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dataset</td><td>Data object containining training data, including covariates, leaf regression bases, and case weights. </td></tr>
    <tr><td class="paramname">tracker</td><td>Tracking data structures that speed up sampler operations. </td></tr>
    <tr><td class="paramname">split</td><td>Proposed split of tree <code>tree_num</code> at node <code>leaf_split</code>. </td></tr>
    <tr><td class="paramname">tree_num</td><td>Index of the tree for which a split is proposed. </td></tr>
    <tr><td class="paramname">leaf_split</td><td>Index of the leaf in <code>tree_num</code> for which a split is proposed. </td></tr>
    <tr><td class="paramname">feature_split</td><td>Index of the feature to which <code>split</code> will be applied </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if <code>split</code> creates two nodes with constant values for every feature in <code>dataset</code>, <code>false</code> otherwise. </dd></dl>

</div>
</div>
<a id="ga68c34c1d30d2ad0503b30e396ec97c09" name="ga68c34c1d30d2ad0503b30e396ec97c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga68c34c1d30d2ad0503b30e396ec97c09">&#9670;&#160;</a></span>GFRSampleOneIter()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LeafModel , typename LeafSuffStat , typename... LeafSuffStatConstructorArgs&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void StochTree::GFRSampleOneIter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1TreeEnsemble.html">TreeEnsemble</a> &amp;&#160;</td>
          <td class="paramname"><em>active_forest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestContainer.html">ForestContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>forests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LeafModel &amp;&#160;</td>
          <td class="paramname"><em>leaf_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ColumnVector.html">ColumnVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1TreePrior.html">TreePrior</a> &amp;&#160;</td>
          <td class="paramname"><em>tree_prior</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 &amp;&#160;</td>
          <td class="paramname"><em>gen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>variable_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>global_variance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; FeatureType &gt; &amp;&#160;</td>
          <td class="paramname"><em>feature_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cutpoint_grid_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keep_forest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>pre_initialized</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>backfitting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LeafSuffStatConstructorArgs &amp;...&#160;</td>
          <td class="paramname"><em>leaf_suff_stat_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs one iteration of the MCMC sampler for a tree ensemble model, which consists of two steps for every tree in a forest:</p><ol type="1">
<li>Sampling "birth-death" tree modifications via the Metropolis-Hastings algorithm</li>
<li>Sampling leaf node parameters, conditional on a (possibly-updated) tree, via a Gibbs sampler</li>
</ol>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">LeafModel</td><td>Leaf model type (i.e. <code><a class="el" href="classStochTree_1_1GaussianConstantLeafModel.html" title="Marginal likelihood and posterior computation for gaussian homoskedastic constant leaf outcome model.">GaussianConstantLeafModel</a></code>, <code><a class="el" href="classStochTree_1_1GaussianUnivariateRegressionLeafModel.html" title="Marginal likelihood and posterior computation for gaussian homoskedastic constant leaf outcome model.">GaussianUnivariateRegressionLeafModel</a></code>, etc...) </td></tr>
    <tr><td class="paramname">LeafSuffStat</td><td>Leaf sufficient statistic type (i.e. <code><a class="el" href="classStochTree_1_1GaussianConstantSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianConstantSuffStat</a></code>, <code><a class="el" href="classStochTree_1_1GaussianUnivariateRegressionSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianUnivariateRegressionSuffStat</a></code>, etc...) </td></tr>
    <tr><td class="paramname">LeafSuffStatConstructorArgs</td><td>Type of constructor arguments used to initialize <code>LeafSuffStat</code> class. For <code><a class="el" href="classStochTree_1_1GaussianMultivariateRegressionSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianMultivariateRegressionSuffStat</a></code>, this is <code>int</code>, while each of the other three sufficient statistic classes do not take a constructor argument. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">active_forest</td><td>Current state of an ensemble from the sampler's perspective. This is managed through an "active forest" class, as distinct from a "forest container" class of stored ensemble samples because we often wish to update model state without saving the result (e.g. during burn-in or thinning of an MCMC sampler). </td></tr>
    <tr><td class="paramname">tracker</td><td>Tracking data structures that speed up sampler operations, synchronized with <code>active_forest</code> tracking a forest's state. </td></tr>
    <tr><td class="paramname">forests</td><td>Container of "stored" forests. </td></tr>
    <tr><td class="paramname">leaf_model</td><td>Leaf model object &ndash; type is determined by template argument <code>LeafModel</code>. </td></tr>
    <tr><td class="paramname">dataset</td><td>Data object containining training data, including covariates, leaf regression bases, and case weights. </td></tr>
    <tr><td class="paramname">residual</td><td>Data object containing residual used in training. The state of <code>residual</code> is updated by this function (the prior predictions of <code>active_forest</code> are added to the residual and the updated predictions from <code>active_forest</code> are subtracted back out). </td></tr>
    <tr><td class="paramname">tree_prior</td><td>Configuration for tree prior (i.e. max depth, min samples in a leaf, depth-defined split probability). </td></tr>
    <tr><td class="paramname">gen</td><td>Random number generator for sampler. </td></tr>
    <tr><td class="paramname">variable_weights</td><td>Vector of selection weights for each variable in <code>dataset</code>. </td></tr>
    <tr><td class="paramname">global_variance</td><td>Current value of (possibly stochastic) global error variance parameter. </td></tr>
    <tr><td class="paramname">feature_types</td><td>Enum-coded vector of feature types (see FeatureType) for each feature in <code>dataset</code>. </td></tr>
    <tr><td class="paramname">cutpoint_grid_size</td><td>Maximum size of a grid of potential cutpoints (the grow-from-root algorithm evaluates a series of potential cutpoints for each feature and this parameter "thins" the cutpoint candidates for numeric variables). </td></tr>
    <tr><td class="paramname">keep_forest</td><td>Whether or not <code>active_forest</code> should be retained in <code>forests</code>. </td></tr>
    <tr><td class="paramname">pre_initialized</td><td>Whether or not <code>active_forest</code> has already been initialized (note: this parameter will be refactored out soon). </td></tr>
    <tr><td class="paramname">backfitting</td><td>Whether or not the sampler uses "backfitting" (wherein the sampler for a given tree only depends on the other trees via their effect on the residual) or the more general "blocked MCMC" (wherein the state of other trees must be more explicitly considered). </td></tr>
    <tr><td class="paramname">leaf_suff_stat_args</td><td>Any arguments which must be supplied to initialize a <code>LeafSuffStat</code> object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga08eabd64880e15e5ee94e8ad48110208" name="ga08eabd64880e15e5ee94e8ad48110208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga08eabd64880e15e5ee94e8ad48110208">&#9670;&#160;</a></span>MCMCSampleOneIter()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LeafModel , typename LeafSuffStat , typename... LeafSuffStatConstructorArgs&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void StochTree::MCMCSampleOneIter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1TreeEnsemble.html">TreeEnsemble</a> &amp;&#160;</td>
          <td class="paramname"><em>active_forest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestTracker.html">ForestTracker</a> &amp;&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestContainer.html">ForestContainer</a> &amp;&#160;</td>
          <td class="paramname"><em>forests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LeafModel &amp;&#160;</td>
          <td class="paramname"><em>leaf_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ForestDataset.html">ForestDataset</a> &amp;&#160;</td>
          <td class="paramname"><em>dataset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1ColumnVector.html">ColumnVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStochTree_1_1TreePrior.html">TreePrior</a> &amp;&#160;</td>
          <td class="paramname"><em>tree_prior</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 &amp;&#160;</td>
          <td class="paramname"><em>gen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>variable_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>global_variance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keep_forest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>pre_initialized</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>backfitting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LeafSuffStatConstructorArgs &amp;...&#160;</td>
          <td class="paramname"><em>leaf_suff_stat_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Runs one iteration of the MCMC sampler for a tree ensemble model, which consists of two steps for every tree in a forest: </p>
<ol type="1">
<li>Sampling "birth-death" tree modifications via the Metropolis-Hastings algorithm</li>
<li>Sampling leaf node parameters, conditional on a (possibly-updated) tree, via a Gibbs sampler</li>
</ol>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">LeafModel</td><td>Leaf model type (i.e. <code><a class="el" href="classStochTree_1_1GaussianConstantLeafModel.html" title="Marginal likelihood and posterior computation for gaussian homoskedastic constant leaf outcome model.">GaussianConstantLeafModel</a></code>, <code><a class="el" href="classStochTree_1_1GaussianUnivariateRegressionLeafModel.html" title="Marginal likelihood and posterior computation for gaussian homoskedastic constant leaf outcome model.">GaussianUnivariateRegressionLeafModel</a></code>, etc...) </td></tr>
    <tr><td class="paramname">LeafSuffStat</td><td>Leaf sufficient statistic type (i.e. <code><a class="el" href="classStochTree_1_1GaussianConstantSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianConstantSuffStat</a></code>, <code><a class="el" href="classStochTree_1_1GaussianUnivariateRegressionSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianUnivariateRegressionSuffStat</a></code>, etc...) </td></tr>
    <tr><td class="paramname">LeafSuffStatConstructorArgs</td><td>Type of constructor arguments used to initialize <code>LeafSuffStat</code> class. For <code><a class="el" href="classStochTree_1_1GaussianMultivariateRegressionSuffStat.html" title="Sufficient statistic and associated operations for gaussian homoskedastic constant leaf outcome model...">GaussianMultivariateRegressionSuffStat</a></code>, this is <code>int</code>, while each of the other three sufficient statistic classes do not take a constructor argument. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">active_forest</td><td>Current state of an ensemble from the sampler's perspective. This is managed through an "active forest" class, as distinct from a "forest container" class of stored ensemble samples because we often wish to update model state without saving the result (e.g. during burn-in or thinning of an MCMC sampler). </td></tr>
    <tr><td class="paramname">tracker</td><td>Tracking data structures that speed up sampler operations, synchronized with <code>active_forest</code> tracking a forest's state. </td></tr>
    <tr><td class="paramname">forests</td><td>Container of "stored" forests. </td></tr>
    <tr><td class="paramname">leaf_model</td><td>Leaf model object &ndash; type is determined by template argument <code>LeafModel</code>. </td></tr>
    <tr><td class="paramname">dataset</td><td>Data object containining training data, including covariates, leaf regression bases, and case weights. </td></tr>
    <tr><td class="paramname">residual</td><td>Data object containing residual used in training. The state of <code>residual</code> is updated by this function (the prior predictions of <code>active_forest</code> are added to the residual and the updated predictions from <code>active_forest</code> are subtracted back out). </td></tr>
    <tr><td class="paramname">tree_prior</td><td>Configuration for tree prior (i.e. max depth, min samples in a leaf, depth-defined split probability). </td></tr>
    <tr><td class="paramname">gen</td><td>Random number generator for sampler. </td></tr>
    <tr><td class="paramname">variable_weights</td><td>Vector of selection weights for each variable in <code>dataset</code>. </td></tr>
    <tr><td class="paramname">global_variance</td><td>Current value of (possibly stochastic) global error variance parameter. </td></tr>
    <tr><td class="paramname">keep_forest</td><td>Whether or not <code>active_forest</code> should be retained in <code>forests</code>. </td></tr>
    <tr><td class="paramname">pre_initialized</td><td>Whether or not <code>active_forest</code> has already been initialized (note: this parameter will be refactored out soon). </td></tr>
    <tr><td class="paramname">backfitting</td><td>Whether or not the sampler uses "backfitting" (wherein the sampler for a given tree only depends on the other trees via their effect on the residual) or the more general "blocked MCMC" (wherein the state of other trees must be more explicitly considered). </td></tr>
    <tr><td class="paramname">leaf_suff_stat_args</td><td>Any arguments which must be supplied to initialize a <code>LeafSuffStat</code> object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
